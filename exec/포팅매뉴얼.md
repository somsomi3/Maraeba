# 포팅 매뉴얼

## 개발 환경
1. 서버 및 DevOps
   AWS EC2, Nginx, Docker, Jenkins


<br>

2. 프론트엔드
   -   Visual Studio Code
   -   React 18.3.1
   -   Redux (@reduxjs/toolkit 2.5.1, react-redux 9.2.0)
   -   react-router-dom 6.28.2
   -   axios 1.7.9
   -   jwt-decode 4.0.0
   -   chart.js (chart.js 4.4.7, react-chartjs-2 5.3.0)
   -   Redis 4.7.0
   -   Vite 6.0.5

<br>

3. 백엔드

   | 기술스택            | 버전   | 기타 |
      |-----------------| ------ | ---- |
   | java            | 17     |      |
   | spring          | 6.1.2  |      |
   | spring boot3    | 3.4.2  |      |
   | spring security | 6.2.2  |      |
   | spring data JPA     | 3.4.2    |                        |
   | spring data redis   | 3.4.2    |                        |
   | spring session      | 3.4.2    | redis 사용              |
   | spring websocket    | 6.1.2    |                        |
   | spring validation   | 6.1.2    |                        |
   | spring web          | 6.1.2    |                        |
   | spring webflux      | 6.1.2    |                        |
   | springdoc-openapi   | 2.8.0    | Swagger UI 사용          |
   | mysql               | 8.1.0    | mysql-connector-j      |
   | lombok              | 1.18.28  |                        |
   | jjwt                | 0.12.6   | JWT 인증 및 인가         |
   | jackson-databind    | 2.15.2   | JSON 직렬화 및 역직렬화 |
   | mail service        | 3.4.2    | 이메일 발송 기능          |
   | junit               | 5.10.0   | 테스트                   |
   | reactor-test        | 3.5.11   | WebFlux 테스트           |


<br>

4. DB
   MySQL
   Redis

<br>

5. CI/CD
-   AWS EC2
-   Docker
-   Jenkins



## 빌드 및 배포 작업 문서

### 포트 설정
프론트 : 80
백엔드(스프링) : 8081
DB : 3306
Redis : 6379
Jenkins : 8080
flask : 5000

### 데이터베이스 접속 정보
MySQL
계정 : pororo
Database : maraeba_db

### 빌드 및 실행 방법
1. 도커 네트워크 생성
```
docker network create my_network
```
2. flask 도커 이미지 빌드
```
cd ai
cp {환경변수 파일 경로} .env
docker build -t flask .
```
3. flask 도커 이미지 실행
```
docker run -d --name flask --network my_network flask
```
4. spring 도커 이미지 빌드
```
cd be
docker build -t spring .
```
5. spring 도커 이미지 실행
```
docker run -d --name spring \
             -p 8083:8081 \
                    --network my_network \
                    -v {yml 파일 경로}:/app/config/application.yml \
                    -e SPRING_CONFIG_LOCATION=file:/app/config/application.yml \
                    spring
```
6. react 도커 이미지 빌드
```
cd fe
cp ${환경변수 파일 경로} .env
docker build -t react .
```
7. react 도커 이미지 실행
```
docker run -d --name react \
                    --network my_network \
                    --env-file {환경변수 파일 경로} \
                    -p 8082:80 \
                    react
```

### 외부 서비스 접속 방법
1. 카카오페이
- 준비: 카카오페이 API 등록
  kakao.pay.secret_key={Secret key(dev)}
   - 내 애플리케이션 > 애플리케이션 생성하기 -> Secret key(dev) 발급
     kakao.pay.request.url=https://open-api.kakaopay.com/online/v1/payment/ready
     kakao.pay.approve.url=https://open-api.kakaopay.com/online/v1/payment/approve
- 애플리케이션 > 플랫폼 > Web > 사이트 도메인 -> 플랫폼 등록


2. ReturnZero (STT API)
- 준비: My 콘솔 등록
  client-id={CLIENT ID}
   - My 콘솔 > Console > 애플리케이션 정보 > CLIENT ID 복사
     client-secret={CLIENT SECRET}
   - My 콘솔 > Console > CLIENT SECRET 관리 > 발급요청


3. coolsms (휴대폰 인증)
- 준비: coolsms 계정 등록
  sms-api-key={API Key}
   - 개발 / 연동 > API Key 관리 > 새 API KEY 생성 > API Key 복사
     sms-api-secret={API Secret}
   - 개발 / 연동 > API Key 관리 > 새 API KEY 생성 > API Secret 키 복사


4. Firebase (신고 기능)
- 준비: 새 프로젝트 추가 (kppsc00 계정 로그인)
  serviceAccountKey.json
   - 프로젝트 개요 > 프로젝트 설정 > 서비스 계정 > 새 비공개 키 생성 후 파일 저장